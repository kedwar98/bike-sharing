import pylab
import calendar
import numpy as np
import pandas as pd
import seaborn as sn
from scipy import stats
#import missingno as msno
from datetime import datetime
import matplotlib
import matplotlib.pyplot as plt
import warnings
from itertools import groupby  
from itertools import zip_longest 
pd.options.mode.chained_assignment = None
warnings.filterwarnings("ignore", category=DeprecationWarning)
%matplotlib inline



#example

DCdf = pd.read_excel('/Users/rachelschaefer/Documents/CLIMATEDATA.xlsx', sheet_name = 0)       #sheet indices start at 0
NYCdf = pd.read_excel('/Users/rachelschaefer/Documents/CLIMATEDATA.xlsx', sheet_name = 1)
LAdf = pd.read_excel('/Users/rachelschaefer/Documents/CLIMATEDATA.xlsx', sheet_name = 2)
Bostondf = pd.read_excel('/Users/rachelschaefer/Documents/CLIMATEDATA.xlsx', sheet_name = 3)
Phildf = pd.read_excel('/Users/rachelschaefer/Documents/CLIMATEDATA.xlsx', sheet_name = 4)
Chicdf = pd.read_excel('/Users/rachelschaefer/Documents/CLIMATEDATA.xlsx', sheet_name = 5)


#%%

def weather_data_proc(data):
#remove all but last duplicate of hours (when multiple reports are made in one hour - taking the last maximizes the time between reports
    datanew=data.copy()       #can be important to make copies so you aren't editing the original ('=' usually means a reference to the same thing, not a new copy)
    datanew['DATE'] = pd.to_datetime(datanew['DATE'])
    datanew['DATE'] = datanew['DATE'].dt.floor('h')    #truncate to hours
    datanew=datanew[~datanew['DATE'].duplicated(keep='last')]
    return datanew

NYCdfex=weather_data_proc(NYCdf)
Bostondfex=weather_data_proc(Bostondf)

examplediffs=set(Bostondfex['DATE']) ^ set(NYCdfex['DATE'])

DCdfex=weather_data_proc(DCdf)
LAdfex=weather_data_proc(LAdf)
Phildfex=weather_data_proc(Phildf)
Chicdfex=weather_data_proc(Chicdf)


#%%

def resample_with_zeros(data):
#fill in missing hours as new rows with 0 for the DATE column (change fillna argument for other replacement)
    datadf=data.copy()
    datadf.index=range(datadf.shape[0])
    datadf=datadf.set_index(pd.to_datetime(datadf['DATE']))
    datadf=datadf.resample('H').first().fillna(0)    
    return datadf

NYCdfex=weather_data_proc(NYCdfex)
Bostondfex=weather_data_proc(Bostondfex)
DCdfex=weather_data_proc(DCdfex)
LAdfex=weather_data_proc(LAdfex)
Phildfex=weather_data_proc(Phildfex)
Chicdfex=weather_data_proc(Chicdfex) 
